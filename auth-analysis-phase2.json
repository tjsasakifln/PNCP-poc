{
  "timestamp": "2026-02-09T20:31:25.803Z",
  "middlewareAnalysis": {
    "backend/auth.py": {
      "hasGetUser": true,
      "hasVerifyToken": false,
      "hasSupabase": true,
      "hasBearer": true,
      "linesOfCode": 68
    },
    "backend/tests/test_auth.py": {
      "hasGetUser": true,
      "hasVerifyToken": false,
      "hasSupabase": true,
      "hasBearer": true,
      "linesOfCode": 347
    },
    "frontend/e2e-tests/auth-ux.spec.ts": {
      "hasGetUser": false,
      "hasVerifyToken": false,
      "hasSupabase": false,
      "hasBearer": false,
      "linesOfCode": 310
    },
    "frontend/middleware.ts": {
      "hasGetUser": true,
      "hasVerifyToken": false,
      "hasSupabase": true,
      "hasBearer": false,
      "linesOfCode": 172
    },
    "scripts/configure-supabase-oauth.js": {
      "hasGetUser": false,
      "hasVerifyToken": false,
      "hasSupabase": true,
      "hasBearer": true,
      "linesOfCode": 296
    }
  },
  "endpointAnalysis": {
    "/me": {
      "found": true,
      "files": [
        ".playwright-mcp/console-errors.txt",
        ".playwright-mcp/network-requests.txt",
        ".playwright-mcp/page-2026-02-09T01-26-51-407Z.png",
        "DEPLOYMENT-SUMMARY.md",
        "STORY-171-BACKEND-QUICKSTART.md",
        "backend/clients/base.py",
        "backend/main.py",
        "backend/routes/features.py",
        "backend/routes/messages.py",
        "backend/schemas.py",
        "backend/services/base.py",
        "backend/tests/test_api_me.py",
        "backend/tests/test_endpoints_story165.py",
        "backend/tests/test_feature_flags.py",
        "backend/unified_schemas/unified.py",
        "docs/STATUS.md",
        "docs/analytics/alert-runbook.md",
        "docs/architecture/adr-multi-source-consolidation.md",
        "docs/architecture/adr-plan-capabilities.md",
        "docs/architecture/multi-source-api-contract.md",
        "docs/content-strategy/competitor-comparison.md",
        "docs/content-strategy/pain-points-validation.md",
        "docs/content-strategy/value-proposition.md",
        "docs/data/pydantic-models-design.md",
        "docs/deployment/DEPLOYMENT-CHECKLIST.md",
        "docs/deployment/QUICK-DEPLOY-GUIDE.md",
        "docs/deployment/README-STORY165-DEPLOYMENT.md",
        "docs/deployment/README-STORY165-TESTING.md",
        "docs/deployment/STAGING-DEPLOYMENT-REPORT.md",
        "docs/deployment/deployment-runbook-story165.md",
        "docs/deployment/go-no-go-decision-story165.md",
        "docs/deployment/incident-response-story165.md",
        "docs/deployment/monitoring-story165.md",
        "docs/deployment/oncall-quick-reference-story165.md",
        "docs/deployment/production-rollout-checklist-story165.md",
        "docs/deployment/quality-gate-report-story165.md",
        "docs/deployment/quality-gate-summary.md",
        "docs/deployment/railway-environment-setup.md",
        "docs/deployment/rollback-plan-story165.md",
        "docs/deployment/smoke-tests-story165.md",
        "docs/deployment/staging-deployment-announcement.md",
        "docs/deployment/staging-smoke-test-checklist.md",
        "docs/deployment/staging-smoke-test-execution-plan.md",
        "docs/deployment/staging-smoke-test-results-template.md",
        "docs/deployment/staging-test-data-setup.md",
        "docs/deployment/story165-deployment-checklist.md",
        "docs/features/annual-subscription.md",
        "docs/implementation/STORY-171-backend-implementation.md",
        "docs/research/multi-source-api-analysis.md",
        "docs/sessions/2026-02/session-165-backend-progress.md",
        "docs/stories/STORY-165-plan-restructuring.md",
        "docs/stories/STORY-171-PARALLEL-SQUAD-COMPLETION.md",
        "docs/stories/STORY-171-annual-subscription-toggle.md",
        "docs/stories/STORY-171-architect-review.md",
        "docs/stories/STORY-171-documentation-index.md",
        "docs/stories/STORY-171-documentation-summary.md",
        "docs/stories/STORY-173-brand-positioning-value-prop.md",
        "docs/stories/story-facilities-rebranding.md",
        "docs/stripe/STRIPE_INTEGRATION.md",
        "docs/stripe/TRACK-3-COMPLETION-SUMMARY.md",
        "docs/support/faq-annual-plans.md",
        "docs/testing/performance-testing-guide.md",
        "docs/ux/STORY-165-plan-ui-design.md",
        "fix-svg-aria.js",
        "frontend/__tests__/components/AuthProvider.test.tsx",
        "frontend/__tests__/hooks/useFeatureFlags.test.ts",
        "frontend/__tests__/pages/PlanosPage.test.tsx",
        "frontend/app/admin/page.tsx",
        "frontend/app/api/me/route.ts",
        "frontend/app/api/messages/conversations/[id]/reply/route.ts",
        "frontend/app/api/messages/conversations/[id]/route.ts",
        "frontend/app/api/messages/conversations/[id]/status/route.ts",
        "frontend/app/api/messages/conversations/route.ts",
        "frontend/app/api/messages/unread-count/route.ts",
        "frontend/app/components/AuthProvider.tsx",
        "frontend/app/components/MessageBadge.tsx",
        "frontend/app/components/UserMenu.tsx",
        "frontend/app/mensagens/page.tsx",
        "frontend/app/planos/page.tsx",
        "frontend/components/subscriptions/IMPLEMENTATION-SUMMARY.md",
        "frontend/components/subscriptions/README.md",
        "frontend/e2e-tests/helpers/test-utils.ts",
        "frontend/hooks/useFeatureFlags.ts",
        "frontend/hooks/usePlan.ts",
        "frontend/hooks/useQuota.ts",
        "frontend/hooks/useUnreadCount.ts",
        "frontend/lib/plans.ts",
        "frontend/next.config.js",
        "frontend/package-lock.json",
        "gtm-inspection-13-termos-especificos-bug.png"
      ]
    },
    "/api/messages": {
      "found": true,
      "files": [
        "backend/routes/messages.py",
        "frontend/app/api/messages/conversations/[id]/reply/route.ts",
        "frontend/app/api/messages/conversations/[id]/route.ts",
        "frontend/app/api/messages/conversations/[id]/status/route.ts",
        "frontend/app/api/messages/conversations/route.ts",
        "frontend/app/api/messages/unread-count/route.ts",
        "frontend/app/mensagens/page.tsx",
        "frontend/hooks/useUnreadCount.ts"
      ]
    },
    "unread-count": {
      "found": true,
      "files": [
        "backend/routes/messages.py",
        "frontend/app/api/messages/unread-count/route.ts",
        "frontend/hooks/useUnreadCount.ts"
      ]
    }
  },
  "configIssues": [],
  "recommendations": [
    "Comparar implementação de auth entre /me e /api/messages",
    "Verificar se ambos endpoints usam mesmo método de validação (getUser vs verifyToken)"
  ],
  "authFiles": [
    "backend/auth.py",
    "backend/tests/test_auth.py",
    "frontend/e2e-tests/auth-ux.spec.ts",
    "frontend/middleware.ts",
    "scripts/configure-supabase-oauth.js"
  ],
  "corsFiles": [
    "CHANGELOG.md",
    "PRD.md",
    "README.md",
    "ROADMAP.md",
    "backend/config.py",
    "backend/main.py",
    "backend/tests/test_config.py",
    "backend/tests/test_main.py",
    "create-issues-part2.sh",
    "create-issues.sh",
    "criar-todas-issues.ps1",
    "docs/DEPLOYMENT.md",
    "docs/INTEGRATION.md",
    "docs/architecture/system-architecture-v2.md",
    "docs/deployment/phase4-devops-readiness-report.md",
    "docs/deployment/pre-deployment-checklist.md",
    "docs/framework/coding-standards.md",
    "docs/frontend/frontend-spec.md",
    "docs/prd/technical-debt-DRAFT.md",
    "docs/prd/technical-debt-assessment.md",
    "docs/runbooks/rollback-procedure.md",
    "docs/sprints/value-sprint-01-phase-2-execution-report.md",
    "docs/stories/epic-technical-debt.md",
    "docs/testing/phase4-smoke-test-report.md",
    "frontend/e2e-tests/admin-users.spec.ts",
    "scripts/verify-integration.sh"
  ],
  "envVars": [
    "SUPABASE_URL",
    "SUPABASE_ANON_KEY",
    "SUPABASE_SERVICE_ROLE_KEY"
  ]
}